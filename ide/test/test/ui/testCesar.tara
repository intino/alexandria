dsl Konos

Service (title = "", favicon = "") testCesar as UI
	Resource("/", uses=testCesarDesktop) testCesarHomePage as Root

Display testCesarHome
Display systemLoad
	Notification render as Object(systemLoadMetrics)
	Notification update as Object(systemLoadMetrics)
	Request reload

Display deviceLoad
	Notification render as Object(deviceLoadMetrics)
	Notification update as Object(deviceLoadMetrics)
	Request reload

Display deviceIssuesTimeLine
	Notification render as List Object(deviceTimelineEvent)
	Notification update as List Object(deviceTimelineEvent)
	Request reload as Object(timeRange)

Display cesarDeviceOperations
	Notification render as Object(deviceIssues)
	Notification update as Object(deviceIssues)
	Request reload

Display cesarDeviceRules
	Notification render as Object(deviceIssues)
	Request reload

Panel(title = "test cesar", subTitle = "test using cesar layout", logoPath = "favicon.png", faviconPath = "favicon.png") testCesarDesktop as Desktop
	Views

Panel cesarDevicePanel
	Views
		View("info", layout=LeftFixed) as MoldContainer(deviceInfoMold)
		View("status") as MoldContainer(deviceMold)
		View("rules") as MoldContainer(deviceRulesMold)
		View("operations") operations as MoldContainer(deviceOperationsMold)

Mold(modelClass="io.intino.cesar.graph.Device") deviceInfoMold
	Block(Vertical)
		Block(Horizontal Center)
			Title(defaultStyle = "margin:0px 0px;font-weight:normal;font-size:12pt !important;") label
			TaskOperation(label = "refresh", defaultStyle = "margin:0px 10px;", mode = Icon, alexandriaIcon = "icons:update") refresh
		Block
			Picture(defaultPicture = "/images/tablet_no_status.png", defaultStyle = "width:210px;") image
		Block(Horizontal Center)
			Title(defaultStyle = "margin:0px 0px;font-weight:normal;font-size:12pt !important;") consul
			Title(defaultStyle = "margin:0px 5px;font-weight:normal;font-size:12pt !important;") consulVersion
			TaskOperation(label = "update", defaultStyle = "margin:0px 10px;", mode = Icon, alexandriaIcon = "icons:system-update-alt") update
		Block(Horizontal CenterJustified)
			TaskOperation(label = "shutdown", defaultStyle = "width:50% margin:0 10px", hasCustomStyle = true) shutdown
			TaskOperation(label = "reboot", defaultStyle = "width:50%", hasCustomStyle = true) reboot
		Block(hidden = HiddenEnabled) mapBlock
			Map(zoom = 5, latitude = 19.2643486, longitude = -99.2086771, defaultStyle = "margin-top:10px;width:200px;height:200px") mapa

Mold(modelClass = "io.intino.cesar.graph.Device") deviceMold
	Block(Horizontal Center, style = "margin:8px 0 10px 10px;")
		Title(defaultStyle = "font-weight:normal;font-size:12pt !important;") On
	Block(Horizontal Center, style = "margin:0 0 10px 10px;")
		Block(Vertical Center, hidden = HiddenEnabled, style = "margin:0 15px 0 0") connectionBlock
			Icon(source = Polymer) connectionIcon > defaultStyle = "height:64px;width:64px;margin-bottom:2px;margin-top:5px;"
			Description connectionDescription > defaultStyle = "color:#888;font-size:10pt !important;margin-bottom:3px;"
			Title connectionStatus > defaultStyle = "font-size:12pt;color:black;"
		Block(Vertical Center, hidden = HiddenEnabled, style = "margin:0 15px 0 0") screenBlock
			Icon(source = Polymer) screenIcon > defaultStyle = "height:64px;width:64px;margin-bottom:2px;margin-top:5px;"
			Description screenDescription > defaultStyle = "color:#888;font-size:10pt !important;margin-bottom:3px;"
			Title screenStatus > defaultStyle = "font-size:12pt;color:black;"
		Block(Vertical Center, hidden = HiddenEnabled, style = "margin:0 15px") powerBlock
			Icon(source = Polymer) powerIcon > defaultStyle = "height:64px;width:64px;margin-bottom:2px;margin-top:5px;"
			Description powerDescription > defaultStyle = "color:#888;font-size:10pt !important;margin-bottom:3px;"
			Title powerStatus > defaultStyle =  "font-size:12pt;color:black;"
		Block(Vertical Center, hidden = HiddenEnabled, style = "margin:0 15px") batteryBlock
			Icon(source = Polymer) batteryIcon > defaultStyle = "height:64px;width:64px;margin-bottom:2px;margin-top:5px;"
			Description batteryDescription > defaultStyle = "color:#888;font-size:10pt !important;margin-bottom:3px;"
			Title batteryStatus > defaultStyle = "font-size:12pt;color:black;"
		Block(Vertical Center, hidden = HiddenEnabled, style = "margin:0 15px") temperatureBlock
			Icon(source = Polymer) temperatureIcon > defaultStyle = "height:64px;width:64px;margin-bottom:2px;margin-top:5px;"
			Description temperatureDescription > defaultStyle = "color:#888;font-size:10pt !important;margin-bottom:3px;"
			Title temperatureStatus > defaultStyle = "font-size:12pt;color:black;"
	Block(Horizontal Justified, style = "margin-top10px;border-top:1px solid #dfdfdf;margin:0 0 10px 10px;")
		Title(defaultStyle = "font-weight:normal;margin:20px 0 5px 0;font-size:12pt !important;") timeline
	Block(Horizontal Center, style = "margin:0 0 10px 10px;")
		EmbeddedDisplay(defaultStyle = "width:100%;", display = deviceIssuesTimeLine) deviceTimeLine

Mold(modelClass = "io.intino.cesar.graph.Device") deviceRulesMold
	Block(Horizontal Center, style = "margin: 0 26px 20px;width:calc(100% - 52px);min-height:300px;")
		EmbeddedDisplay(defaultStyle = "width:100%;", display = cesarDeviceRules) deviceRules

Mold(modelClass = "io.intino.cesar.graph.Device") deviceOperationsMold
	Block(Horizontal Center, style = "margin: 0 26px 20px;width:calc(100% - 52px);min-height:300px;")
		EmbeddedDisplay(defaultStyle = "width:100%;", display = cesarDeviceOperations) aaa

Schema Command
	Attribute operation as Text
	AttributeMap parameters

Schema CommandExecuted
	Attribute ts as DateTime
	Attribute commandName as Text
	Attribute remarks as Text
	Attribute deviceId as Text
	Attribute consulVersion as Text

Schema Status
	Attribute deviceId as Text
	Attribute ts as DateTime
	Attribute consulVersion as Text
	Attribute temperature as Real
	Attribute battery as Real
	Attribute cpuUsage as Real
	Attribute isPlugged as Bool
	Attribute isScreenOn as Bool

Schema SystemSchema
	Attribute id as Text
	Attribute jmxPort as Integer
	Attribute publicURL as Text
	Schema(multiple = false) Packaging
		Attribute artifact as Text
		Attribute classpathPrefix as Text
		Schema Parameter
			Attribute name as Text
			Attribute value as Text

	Schema Artifactory
		Attribute id as Text
		Attribute url as Text
		Attribute user as Text
		Attribute password as Text

	Schema(multiple = false) Runtime
		Attribute serverName as Text
		Attribute managementPort as Integer
		Attribute ip as Text
		Attribute port as Integer

Schema ServerSchema
	Attribute name as Text
	Attribute ip as Text
	Attribute performance as Text
	Schema(multiple = false) RemoteConnection
		Attribute url as Text
		Attribute port as Integer
		Attribute user as Text

Schema Boot
	Attribute ts as DateTime
	Attribute deviceId as Text
	Attribute consulVersion as Text

Schema Crash
	Attribute ts as DateTime
	Attribute app as Text
	Attribute appVersion as Text
	Attribute deviceId as Text
	Attribute stack as Text
	Attribute consulVersion as Text

Schema deviceLoadMetrics
	//TODO
Schema systemLoadMetrics
	Attribute updateMinutesInterval as Integer(defaultValue = 15)
	Attribute from as DateTime
	Attribute(multiple = true) cpu as Real
	Attribute(multiple = true) memory as Real
	Attribute(multiple = true) threads as Integer

Schema deviceTimelineEvent
	Attribute id as Text
	Attribute content as Text
	Attribute icon as Text
	Attribute type as Text
	Attribute className as Text
	Attribute start as DateTime
	Attribute end as DateTime

Schema timeRange
	Attribute from as DateTime
	Attribute to as DateTime
	Attribute scale as Text

Dialog(url = "", label = "Issue", description = "") issueDialog
	Tab("Issue") tab
		Text(label = "Issue id") type > readonly = true
		Text(label = "Issue") issue > readonly = true
		Text(label = "instant") moment > readonly = true
		Text(label = "level") level > readonly = true
		Text(label = "remarks") remarks > readonly = true
		Text(label = "log") log > readonly = true
	Toolbar
		Operation(label = "go to item") gotoItem
		Operation(label = "mark solved") resolveIssue
		Operation(label = "discard") discardIssue

Schema deviceIssues
	Schema(multiple = true) Issue
		Attribute ts as DateTime
		Attribute issueType as Text
		Attribute parameters as Text
			multiple = true
