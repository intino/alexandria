<link rel="import" href="../../../../lib/polymer/polymer.html">
<link rel="import" href="../../../../lib/cotton-translator/cotton-translator-behavior.html">
<link rel="import" href="../../../../lib/paper-dialog/paper-dialog.html">
<link rel="import" href="../../../../lib/paper-button/paper-button.html">
<link rel="import" href="alexandria-mold-operation-trigger.html">

<dom-module id="alexandria-mold-task-operation">

    <template>
        <div class="container">
            <alexandria-mold-operation-trigger title="[[_title]]" icon="[[icon]]" styles="[[styles]]" mode="[[mode]]" on-execute="_confirmTask"></alexandria-mold-operation-trigger>
        </div>
        <div id="dialogContainer" class="alexandria-mold-task-operation-0">
            <paper-dialog id="dialog" no-overlap entry-animation="scale-up-animation" exit-animation="fade-out-animation" on-iron-overlay-closed="_overlayClosed">
                <h2>[[Title]]</h2>
                <div class="message">[[confirm]]</div>
                <div class="buttons">
                    <paper-button dialog-dismiss>[[Cancel]]</paper-button>
                    <paper-button dialog-confirm autofocus on-tap="_execute">[[Accept]]</paper-button>
                </div>
            </paper-dialog>
        </div>
    </template>

    <style>
        :host .container {
            margin: 0 !important;
        }
        :host a {
            cursor: pointer;
            color: var(--default-primary-color);
        }
        :host paper-dialog {
            margin: 50px;
            padding: 0;
            background: white;
            border-radius: 10px;
        }
        :host paper-dialog h2 {
            margin-top: 10px;
            font-size: 14pt;
        }
        :host paper-dialog .message {
            margin-top: 0;
            margin-bottom: 5px;
        }
        :host paper-dialog .buttons {
            margin-bottom: 5px;
        }
        :host paper-dialog paper-button {
            padding: 0 10px;
            margin: 0 10px 0 0;
            height: 25px;
            widht: 90px;
        }
    </style>

    <script>
        const AlexandriaMoldTaskOperationDictionary = {
            es: {
                Execute : "ejecutar",
                Title : "confirmar operaci√≥n",
                Accept : "aceptar",
                Cancel : "cancelar"
            },
            en: {
                Execute : "execute",
                Title : "confirm operation",
                Accept : "accept",
                Cancel : "cancel"
            }
        };

        Polymer({
            is: 'alexandria-mold-task-operation',

            behaviors: [ CottonBehaviors.TranslatorBehavior ],

            properties : {
                title : { type: String, observer: '_refreshTitle' },
                document : String,
                width: Number,
                _width : { type: Number, value: function() { return 100; } },
                height: Number,
                _height : { type: Number, value: function() { return 100; } },
                _title : String,
                icon : String,
                styles : String,
                mode : String,
                confirm : { type: String, value: function() { return null; } }
            },

            attached: function () {
                this.translate(AlexandriaMoldTaskOperationDictionary);
            },

            _refreshTitle : function() {
                var titleDefined = this.title != null && this.title != "";
                this._title = titleDefined ? this.title : this.Execute;
            },

            _confirmTask : function(e) {
                if (!this._requireConfirm()) {
                    this._execute();
                    return;
                }
                document.querySelector("body").appendChild(this.$.dialogContainer);
                this.$.dialog.open();
            },

            _requireConfirm : function() {
                return this.confirm != null && this.confirm != "";
            },

            _execute : function() {
                this.fire("do-task");
            },

            _close : function() {
                this.$.dialog.close();
            },

            _overlayClosed : function(e) {
                this.appendChild(this.$.dialogContainer);
            }

        });
    </script>

</dom-module>
