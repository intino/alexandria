<script>
    'use strict';

    var AlexandriaBehaviors = AlexandriaBehaviors || {};

    AlexandriaBehaviors.DialogBoxBehavior = {

        Dictionary : {
            es : {
                Accept : "aceptar"
            },
            en : {
                Accept : "accept"
            }
        },

        properties : {
            _width : { type: Number, value: function() { return 100; } },
            _height : { type: Number, value: function() { return 100; } },
            _position : { type: Object, value: function() { return null; } },
            _toolbarVisible : { type: Boolean, value: function() { return false; } }
        },

        listeners: { 'iron-resize': '_fitDialog' },

        _resize : function() {
            if (this._position != null) this._updatePosition();
            this._fitDialog();
        },

        _fitDialog : function() {
            var style = "";

            if (this._width != 100) {
                var width = $(window).width();
                style += ";width:" + this._width + "%;margin-left:" + ((width-(width*(this._width / 100)))/2) + "px;";
            }
            else style += ";width:calc(100% - 100px)";

            if (this._height != 100) {
                var height = $(window).height();
                style += ";height:" + this._height + "%;margin-top:" + ((height - (height * (this._height / 100))) / 2) + "px;";
            }
            else style += ";height:calc(100% - 100px)";

            this.$.dialog.style.cssText += style;
        },

        open : function() {
            this._fitDialog();
            this.$.dialog.open();
        },

        close : function() {
            this.$.dialog.close();
        },

        _overlayOpened : function(e) {
            var dialog = e.target;
            var overlay = dialog.backdropElement;

            if (overlay.previousSibling !== dialog && !this._overlayFixed) {
                dialog.parentNode.insertBefore(overlay, null);
                this._overlayFixed = true;
            }
        },

        _overlayClosed : function(e) {
            this._overlayFixed = false;
        },

        _closeDialog : function() {
            this.close();
        },

        _updatePosition : function() {
            var dialog = this.$.dialog;
            var left = this._position.left;
            var top = this._position.top;
            var windowWidth = $(window).width();
            var dialogWidth = $(dialog).width();
            var position = left > windowWidth ? "right" : ((left + $(dialog).width()) > windowWidth ? "center" : "left");
            left = position === "left" ? left : left - (position === "center" ? dialogWidth/2 : dialogWidth);
            dialog.style.top = (top + 5) + "px";
            dialog.style.left = (left + 3) + "px";
        }

    };

</script>