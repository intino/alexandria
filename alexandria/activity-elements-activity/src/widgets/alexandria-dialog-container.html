<link rel="import" href="../../lib/polymer/polymer.html">
<link rel="import" href="../../lib/cotton-push/cotton-push-behavior.html">
<link rel="import" href="../../lib/cotton-carrier/cotton-carrier-behavior.html">
<link rel="import" href="../../lib/cotton-zombie/cotton-zombie.html">
<link rel="import" href="../../lib/cotton-translator/cotton-translator-behavior.html">
<link rel="import" href="../../lib/paper-dialog/paper-dialog.html">
<link rel="import" href="../../lib/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../lib/iron-icons/iron-icons.html">
<link rel="import" href="../../lib/neon-animation/animations/scale-up-animation.html">
<link rel="import" href="../../lib/neon-animation/animations/fade-out-animation.html">
<link rel="import" href="../../lib/iron-resizable-behavior/iron-resizable-behavior.html">
<link rel="import" href="_common/alexandria-configuration-behavior.html">
<link rel="import" href="_common/alexandria-dialog-behavior.html">

<script src="alexandriadialogcontainer/requester.js"></script>
<script src="alexandriadialogcontainer/notifier-listener.js"></script>

<dom-module id="alexandria-dialog-container">

    <template>
        <paper-dialog id="dialog" entry-animation="scale-up-animation"
                      exit-animation="fade-out-animation"
                      on-iron-overlay-opened="_overlayOpened"
                      on-iron-overlay-closed="_overlayClosed"
                      with-backdrop>
            <div class="container">
                <div class="header layout horizontal center">
                    <div class="label flex">[[_label]]</div>
                    <paper-icon-button icon="close" on-tap="close"></paper-icon-button>
                </div>
                <div id="dialogContent"></div>
            </div>
        </paper-dialog>
    </template>

    <style>
        :host {
            display: block;
            margin: 0;
            padding: 0;
        }
        :host paper-dialog {
            margin: 50px;
            padding: 0;
            background: white;
        }
        :host paper-dialog paper-icon-button {
            padding: 6px;
        }
        :host paper-dialog .container {
            border: 0;
            overflow: auto;
            border-radius: 2px;
            padding: 0;
            margin: 0;
            width: 100%;
            height: 100%;
        }
        :host paper-dialog .header {
            padding: 5px 5px 5px 15px;
            border-bottom: 1px solid #ddd;
        }
        :host paper-dialog .header .label {
            font-size: 12pt;
        }
        :host paper-dialog #dialogContent {
            border: 0;
            overflow: auto;
            width: 100%;
            height: calc(100% - 51px);
            border-radius: 2px;
        }
    </style>

    <script>

        const AlexandriaDialogContainerDictionary = {
            es: {
                Loading: "cargando di√°logo..."
            },
            en: {
                Loading: "loading dialog..."
            }
        };

        Polymer({
            is: 'alexandria-dialog-container',

            behaviors: [ CottonBehaviors.CarrierBehavior,
                CottonBehaviors.PushBehavior,
                CottonBehaviors.TranslatorBehavior,
                AlexandriaDialogContainerBehaviors.Requester,
                AlexandriaDialogContainerBehaviors.NotifierListener,
                AlexandriaBehaviors.ConfigurationBehavior,
                AlexandriaBehaviors.DialogBehavior,
                Polymer.IronResizableBehavior ],

            properties : {
                _label : String,
                _type : String
            },

            attached : function() {
                this.translate(AlexandriaDialogContainerDictionary);
                this.listenToDisplay();
            },

            _refreshDialog : function(dialog) {
                this._label = dialog.label;
                this._width = dialog.width;
                this._height = dialog.height;
                this._type = dialog.type;
                this._createZombie();
            },

            _createZombie : function() {
                this.$.dialogContent.innerHTML = "";
                var zombie = document.createElement("cotton-zombie");
                zombie.setAttribute("display", this._type);
                zombie.setAttribute("widget", this._type);
                zombie.setAttribute("object", this.display.id);
                this.$.dialogContent.appendChild(zombie);
            }

        });

    </script>
</dom-module>