<!DOCTYPE html>
<html>
<head>
    <title>dialogs</title>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes"/>

    <!-- dependencies (jquery, handlebars and bootstrap) -->
    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.0/handlebars.min.js"></script>
    <link type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet"/>
    <script type="text/javascript" src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>

    <!-- alpaca -->
    <link type="text/css" href="//code.cloudcms.com/alpaca/1.5.17/bootstrap/alpaca.min.css" rel="stylesheet"/>
    <script type="text/javascript" src="//code.cloudcms.com/alpaca/1.5.17/bootstrap/alpaca.js"></script>

    <!-- date, datetime -->
    <script src="../javascript/moment-with-locales.min.js"></script>
    <script src="../javascript/bootstrap-datetimepicker.min.js"></script>
    <link rel="stylesheet" href="../styles/bootstrap-datetimepicker.min.css" />

    <!-- components -->
    <script src="alpaca/dialog-widget.js"></script>
    <script src="alpaca/input-list-widget.js"></script>
    <script src="alpaca/input-widget.js"></script>
    <script src="alpaca/input-widget/date-input-widget.js"></script>
    <script src="alpaca/input-widget/datetime-input-widget.js"></script>
    <script src="alpaca/input-widget/text-input-widget.js"></script>
    <script src="alpaca/input-widget/memo-input-widget.js"></script>
    <script src="alpaca/input-widget/password-input-widget.js"></script>
    <script src="alpaca/input-widget/optionbox-input-widget.js"></script>
    <script src="alpaca/input-widget/checkbox-input-widget.js"></script>
    <script src="alpaca/input-widget/radiobox-input-widget.js"></script>
    <script src="alpaca/input-widget/combobox-input-widget.js"></script>
    <script src="alpaca/input-widget/file-input-widget.js"></script>
    <script src="alpaca/input-widget/picture-input-widget.js"></script>
    <script src="alpaca/input-widget/document-input-widget.js"></script>
    <script src="alpaca/input-widget/section-input-widget.js"></script>
    <script src="alpaca/input-widget/multiple-input-widget.js"></script>
    <script src="alpaca/widget-factory.js"></script>

</head>

<body>
    <div class="dialog"></div>

    <style>
        .widget {
            margin: 10px 20px;
        }
        h3.label {
            padding: 0 0 4px;
            margin: 0;
            display: block;
            font-size: 13pt;
            color: black;
            text-align: left;
        }
        .description {
            font-size: 10pt;
            color: #727272;
            margin-bottom: 15px;
        }
        div.label { /* document and section input title */
            display: inline-block;
            max-width: 100%;
            margin-bottom: 5px;
            font-weight: 700;
        }
        .toolbar {
            border-top: 1px solid #ddd;
            margin: 15px 0;
            padding-top: 10px;
        }
        .toolbar > div {
            float: right;
            margin-left: 10px;
        }
        .tabs .inputs {
            margin: 10px;
        }
        .tabs .inputs > .section {
            border: 1px solid #eee;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .done {
            display: none;
            padding: 5px 20px;
            border-radius: 6px;
        }
        .wizard {
            padding: 0;
            margin-bottom: 10px;
        }
        .wizard .step-description {
            margin-bottom: 15px;
            font-size: 12pt;
            color: #777;
        }
        .input.file button, .input.picture button {
            margin-bottom: 20px;
        }
        .input.file button .title, .input.picture button .title {
            margin-left: 10px;
        }
        .alpaca-field-checkbox > label {
            padding-left: 0;
            font-weight: bold;
        }
        .alpaca-field-array {
            padding: 0;
        }
        .alpaca-field-array legend {
            margin: 0;
            border-bottom: 0;
            font-size: 11pt;
            font-weight: bold;
        }
        .alpaca-field-array .alpaca-field label, .alpaca-field-array .alpaca-field-object legend {
            display: none;
        }
        .input.section {
            border: 0 !important;
        }
        .alpaca-field-object {
            padding: 0;
        }
        .alpaca-field-object .alpaca-container {
            padding: 10px;
        }
        .alpaca-field-object .alpaca-container-item .alpaca-field {
            border: 0;
        }
        .alpaca-field-object > legend {
            font-size: 14pt;
            margin-bottom: 10px;
        }
        .alpaca-control.checkbox {
            margin-top: 0;
        }
        .widget > .title, .widget .toolbar {
            padding: 15px 15px 4px 0px;
            margin: 0;
            position: fixed;
            background: white;
            width: calc(100% - 40px);
            z-index: 1;
        }
        .widget > .title {
            top: 0;
        }
        .widget .toolbar {
            bottom: 0;
            padding-bottom: 15px;
        }
        .widget .inputs, .widget .tabs {
            margin-top: 60px;
            margin-bottom: 90px;
        }
        .widget .tabs .inputs, .widget .form.component-editable .inputs {
            margin: 10px 10px 90px;
        }
        .widget .form.component-editable .inputs {
            background: #efefef;
            border-radius: 10px;
            padding: 15px 10px;
        }
    </style>

    <script>
        $.alpaca.setDefaultLocale("es_ES");

        const DialogAlpacaDictionary = {
            es : {
                continue : "continuar",
                send : "enviar",
                done : "información enviada",
                editDocumentTitle : "editar documento",
                editDocumentDescription : "asistente de edición de documentos",
                editDocumentDownload : "descarcar el documento",
                editDocumentModified : "ya he modificado el documento",
                editDocumentStep1Title : "descargar",
                editDocumentStep1Subtitle : "descargar el documento",
                editDocumentStep1Description : "descarga el documento para poder realizar la edición del documento en su ordenador. Continúa si ya ha descargado el documento.",
                editDocumentStep2Title : "editar",
                editDocumentStep2Subtitle : "editar el documento",
                editDocumentStep2Description : "Abra el documento e introduzca los cambios que desee. Cuando termine deberá subir el documento modificado.",
                editDocumentStep3Title : "reemplazar",
                editDocumentStep3Subtitle : "reemplazar el documento",
                editDocumentStep3Description : "Indique la localización del documento modificado para guardar la última versión en el sistema",
                inputRequired : "el campo es requerido",
                download : "descargar"
            },
            en : {
                continue : "continuar",
                send : "send",
                done : "dialog info sent",
                editDocumentTitle : "edit document",
                editDocumentDescription : "documents edition wizard",
                editDocumentDownload : "download document",
                editDocumentModified : "I have just modified the document",
                editDocumentStep1Title : "download",
                editDocumentStep1Subtitle : "download document",
                editDocumentStep1Description : "Download the document to make the edition of the document in your computer. Continue if you have already downloaded the document.",
                editDocumentStep2Title : "edit",
                editDocumentStep2Subtitle : "edit document",
                editDocumentStep2Description : "Open the document and insert the changes that you want. When you finish, you should upload the modified document.",
                editDocumentStep3Title : "replace",
                editDocumentStep3Subtitle : "replace document",
                editDocumentStep3Description : "Select the modified document from your computer in order to save the last version in the system.",
                inputRequired : "input is required",
                download : "download"
            },
            labelFor: function(name) {
                return DialogAlpacaDictionary[document.language][name];
            },
            words: function() {
                return DialogAlpacaDictionary[document.language];
            }
        };

        document.render = function(dialog, configuration) {
            var language = configuration.language;
            document.language = DialogAlpacaDictionary[language] != null ? language : "es";
            document.resourceManager = configuration.resourceManager;

            var container = document.querySelector(".dialog");
            var widget = AlpacaWidgetFactory.get("dialog");

            container.innerHTML = "";
            widget.render(dialog, container);
        };

        document.refresh = function(inputList) {
            var widget = AlpacaWidgetFactory.get("dialog");
            widget.refresh(inputList, document.querySelector(".dialog"));
        };

        document.done = function() {
            var widget = AlpacaWidgetFactory.get("dialog");
            widget.done(document.querySelector(".dialog"));
        };

        document.sendMessage = function(input, status, message) {
            var widget = AlpacaWidgetFactory.get("dialog");
            var inputElement = widget.getInput(input);
            var inputWidget = AlpacaWidgetFactory.get(inputElement.input.type, inputElement.input.multiple);
            inputWidget.setMessage(inputElement.input, inputElement, status, message);
        };

        document.focus = function(input) {
            var widget = AlpacaWidgetFactory.get("dialog");
            var inputElement = widget.getInput(input);
            var inputWidget = AlpacaWidgetFactory.get(inputElement.input.type, inputElement.input.multiple);
            inputWidget.focus(inputElement.input, inputElement);
        };

        document.pathOf = function(input) {
            var parent = input.getParent();
            var path = parent == null ? input.schema.title : "";

            if (parent != null)
                path = (isSection(parent) || isMultiple(parent) ? parent.schema.title + input.getPath() : input.getPath()) + (path != "" ? "." + path : "");

            path = path.replace(/\//g, ".");
            path = path.replace("[", "");
            path = path.replace("]", "");

            return path[0] == "." ? path.substring(1) : path;
        };

        function isSection(input) {
            return input.schema.inputType == "section";
        }

        function isMultiple(input) {
            return input.schema.type == "array";
        }

    </script>

</body>
</html>
