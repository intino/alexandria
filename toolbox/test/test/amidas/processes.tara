dsl Konos

Procedure(dataHub) gestionarSolicitud
	Process completarSolicitud
		Input(Solicitud)
		Output(SolicitudCompletada)

	Process revisarSolicitud
		Input(SolicitudCompletada)
		Output(SolicitudRevisada)

	Process decidirAccionParaSolicitud
		Input(RequerimientoSolicitado)
		Output(RequerimientoSolicitado)
		Output(EscritoSolicitado)
		Output(InformePropuestaSolicitado)

	// Requerir
	Process escogerTipoRequerimiento
		Input(RequerimientoSolicitado)
		Output(RequerimientoCreado)

	Process firmarRequerimiento
		Input(RequerimientoCreado)
		Output(RequerimientoFirmado)

	Process registrarRequerimiento // rellenar registro de salida
		Input(RequerimientoFirmado)
		Output(RequerimientoRegistrado)

	Process rellenarAcuseReciboRequerimiento
		Input(RequerimientoRegistrado)
		Output(RequerimientoConAcuseRecibo)

	Process publicarEnBoletinRequerimiento
		Input(RequerimientoConAcuseRecibo)
		Output(RequerimientoPublicado)

	Process comprobarRespuestaARequerimiento
		Input(RequerimientoResuelto)
		Output(RequerimientoSolicitado)

	// Realizar escrito
	Process escogerTipoEscrito
		Input(EscritoSolicitado)
		Output(EscritoCreado)

	Process firmarEscrito
		Input(EscritoCreado)
		Output(EscritoFirmado)

	Process registrarEscrito
		Input(EscritoFirmado)
		Output(EscritoRegistrado)

	Process comprobarEscrito
		Input(EscritoRegistrado)
		Output(EscritoResuelto)

	Process guardarEscrito
		Input(EscritoResuelto)

	// Resolver con/sin informe propuesta
	Process escogerTipoIP
		Input(InformePropuestaSolicitado)
		Output(InformePropuestaCreado)

	Process firmarIP
		Input(InformePropuestaCreado)
		Output(InformePropuestaFirmado)

	Process prepararIP
		Input(InformePropuestaFirmado)
		Output(InformePropuestaResolucionSolicitado)

	Process escogerTipoIPR
		Input(InformePropuestaResolucionSolicitado)
		Output(InformePropuestaResolucionCreado)

	Process firmarIPR
		Input(InformePropuestaResolucionCreado)
		Output(InformePropuestaResolucionFirmado)

	Process inscribirIPR
		Input(InformePropuestaResolucionFirmado)
		Output(InformePropuestaResolucionInscrito)

	Process notificarIPR
		Input(InformePropuestaResolucionInscrito)
		Output(InformePropuestaResolucionNotificado)

	Process rellenarAcuseReciboIPR
		Input(InformePropuestaResolucionNotificado)
		Output(InformePropuestaResolucionConAcuseRecibo)

	Process guardarIPR
		Input(InformePropuestaResolucionConAcuseRecibo)

	// Notificar resoluci√≥n
	Process decidirTipoNotificacion
		Input(NotificacionSolicitada)
		Output(NotificacionCreada)

	Process firmarNotificacion
		Input(NotificacionCreada)
		Output(NotificacionFirmada)

	Process registrarNotificacion
		Input(NotificacionFirmada)
		Output(NotificacionRegistrada)

	Process emitirNotificacion
		Input(NotificacionRegistrada)

	// Archivar
	Process archivarSolicitud
		Input(SolicitudArchivada)

	// Registrar documento
	Process registrarDocumento
		Input(Documento)
		Output(DocumentoRegistrado)

	Process completarDocumento
		Input(DocumentoRegistrado)
		Output(DocumentoCompletado)

	Process revisarDocumento
		Input(DocumentoCompletado)
		Output(DocumentoRevisado)


DataHub dataHub as Remote
	BusConnection(busUrl = "", user = "", password = "", clientId = "")
	Tank("solicitudCompletada") solicitudCompletada
	Tank("solicitudRevisada") solicitudRevisada
	Tank("RequerimientoSolicitado")requerimientoSolicitado
	Tank("EscritoSolicitado")escritoSolicitado
	Tank("InformePropuestaSolicitado")propuestaSolicitado
	Tank("SolicitudArchivada")solicitudArchivada
	Tank("RequerimientoCreado")requerimientoCreado

	Feeder(dataHub.solicitudCompletada) completada
		Sensor defecto as FormEdition(path="/editor/solicitud/completar")

	Feeder(dataHub.solicitudRevisada) solicitudRevisada
		Sensor defecto as FormEdition(path="/editor/solicitud/revisar")

	Feeder(dataHub.requerimientoSolicitado dataHub.escritoSolicitado dataHub.propuestaSolicitado dataHub.solicitudArchivada) decidirSolicitud
		Sensor decidirSolicitud as Poll

			Option("Requerir", RequerimientoSolicitado)
			Option("Realizar escrito", EscritoSolicitado)
			Option("Resolver con informe propuesta", InformePropuestaSolicitado)
			Option("Resolver sin informe propuesta", InformePropuestaSolicitado)
			Option("Archivar", SolicitudArchivada)

	Feeder(dataHub.requerimientoCreado) tipoRequerimiento
		Sensor decidirRequerimiento as Poll

			Option("Requerimiento tipo 1", RequerimientoCreado)
			Option("Requerimiento tipo 2", RequerimientoCreado)



Schema OtraDocumentacion
    Attribute descripcion as Text
    Attribute fichero as File List

Schema Message
	Attribute ts as DateTime

Schema Solicitud as ExtensionOf(Message)
	Attribute id as Text
	Attribute asunto as Text
	Attribute expone as Text
	Attribute solicita as Text
	Attribute modoPresentacion as Text // PorComparecenciaEnSede PapelPorCorreoCertificado

	Attribute datosDelSolicitante as Object(DatosDelSolicitante)
	Attribute datosDelRepresentante as Object(DatosDelRepresentante)
	Attribute solicitudDocumento as Object(SolicitudDocumento) List

Schema SolicitudCompletada as ExtensionOf(Message)
	Attribute solicitud as Object(Solicitud)
	Attribute autor as Text

Schema SolicitudRevisada as ExtensionOf(Message)
	Attribute solicitud as Text
	Attribute revision as Text
	Attribute autor as Text

Schema SolicitudArchivada as ExtensionOf(Message)
	Attribute solicitud as Text
	Attribute autor as Text

Schema DatosDelSolicitante
	Attribute tipoDeDocumento as Text
	Attribute numeroDeDocumento as Text
	Attribute primerApellido as Text
	Attribute segundoApellido as Text
	Attribute nombre as Text
	Attribute razonSocial as Text
	Attribute enCalidadDe as Text

Schema DatosDelRepresentante
	Attribute tipoDeDocumento as Text
	Attribute numeroDeDocumento as Text
	Attribute primerApellido as Text
	Attribute segundoApellido as Text
	Attribute nombre as Text
	Attribute razonSocial as Text

Schema SolicitudDocumento
	Attribute descripcion as Text
	Attribute fichero as File

Schema RequerimientoSolicitado
	Attribute ts as DateTime
	Attribute solicitud as Text

Schema RequerimientoCreado
	Attribute ts as DateTime
	Attribute solicitud as Text
	Attribute tipo as Text

Schema EscritoSolicitado
	Attribute ts as DateTime
	Attribute expediente as Text
	Attribute persona as Text

Schema InformePropuestaSolicitado
	Attribute ts as DateTime
	Attribute expediente as Text
	Attribute persona as Text

Schema InformePropuestaCreado
	Attribute ts as DateTime
	Attribute expediente as Text
	Attribute informePropuesta as File
	Attribute persona as Text

Schema InformePropuestaFirmado
	Attribute ts as DateTime
	Attribute expediente as Text
	Attribute signature as Text
	Attribute propuesta as File

Schema InformePropuestaResolucionSolicitado
	Attribute ts as DateTime
	Attribute expediente as Text
	Attribute persona as Text

Schema InformePropuestaResolucionCreado
	Attribute ts as DateTime
	Attribute expediente as Text
	Attribute persona as Text

Schema InformePropuestaResolucionFirmado
	Attribute ts as DateTime
	Attribute expediente as Text
	Attribute signature as Text
	Attribute propuestaResolucion as File

Schema InformePropuestaResolucionInscrito
	Attribute ts as DateTime
	Attribute escrito as Text
	Attribute persona as Text

Schema InformePropuestaResolucionNotificado
	Attribute ts as DateTime
	Attribute notificacion as Text
	Attribute persona as Text

Schema InformePropuestaResolucionConAcuseRecibo
	Attribute ts as DateTime
	Attribute identificadorAcuseRecibo as Text
	Attribute persona as Text


Schema Documento
Schema DocumentoRegistrado
Schema DocumentoCompletado
Schema DocumentoRevisado

Schema Expediente
	Attribute ts as DateTime
	Attribute solicitud as Text
	Attribute numeroRegistroGeneral as Text
	Attribute numeroRegistroSCE as Text
	Attribute fecha as DateTime
	Attribute persona as Text


Schema EscritoCreado
	Attribute ts as DateTime
	Attribute expediente as Text
	Attribute escrito as File
	Attribute persona as Text

Schema EscritoFirmado
	Attribute ts as DateTime
	Attribute expediente as Text
	Attribute signature as Text
	Attribute escrito as File

Schema EscritoRegistrado
	Attribute ts as DateTime
	Attribute expediente as Text
	Attribute numeroRegistro as Text
	Attribute persona as Text

Schema EscritoResuelto
	Attribute ts as DateTime
	Attribute expediente as Text
	Attribute observaciones as Text
	Attribute persona as Text


Schema NotificacionSolicitada
	Attribute ts as DateTime
	Attribute expediente as Text
	Attribute persona as Text

Schema NotificacionCreada
	Attribute ts as DateTime
	Attribute expediente as Text
	Attribute notificacion as File
	Attribute persona as Text

Schema NotificacionFirmada
	Attribute ts as DateTime
	Attribute expediente as Text
	Attribute signature as Text
	Attribute notificacion as File

Schema NotificacionRegistrada
	Attribute ts as DateTime
	Attribute notificacion as Text
	Attribute numeroRegistro as Text
	Attribute persona as Text


Schema RequerimientoFirmado
	Attribute ts as DateTime
	Attribute requerimiento as Text
	Attribute solicitud as Text

Schema RequerimientoRegistrado
	Attribute ts as DateTime
	Attribute requerimiento as Text
	Attribute solicitud as Text
	Attribute fechaRegistro as DateTime

Schema RequerimientoConAcuseRecibo
	Attribute ts as DateTime
	Attribute requerimiento as Text
	Attribute solicitud as Text
	Attribute identificadorAcuseRecibo as Text

Schema RequerimientoPublicado
	Attribute ts as DateTime
	Attribute requerimiento as Text
	Attribute solicitud as Text
	Attribute entradaEnBoletin as Text

Schema RequerimientoResuelto
	Attribute ts as DateTime
	Attribute requerimiento as Text
	Attribute solicitud as Text