dsl Konos

MessageHub messageHub as JmsBus("{bus}", "{bus-user}", "{bus-password}", "{bus-client-id}")

Service ProcessInbox as Messaging(messageHub)
	domain = "unit1"
	Request("status") status
		Response as Object(ServerStatus)
	Request("reboot") reboot
		Parameter process as Object(Budget)
		Response as Bool
	Request("deploy") deploy
		Parameter process as Object(Budget)
		Response
	Request("task") task as ProcessTrigger(wf.helloWorld)
		Parameter process as Object(ProcessSchema)
		Response as Object(schema = DeployResult)

Workflow("unit1") wf
	Process(bpmn = "service.bpmn") service
	Process(bpmn = "helloworld.bpmn") helloWorld

Sentinel toReservoir as ClockListener("0 0 0 1/1 * ? *", "daily starting at 00:00")
Sentinel toReservoir2 as DirectoryListener("./temp", OnModify)

Schema Budget
	Attribute total as Real

Schema ProcessSchema
	Attribute project as Text
	Attribute name as Text
	Attribute classpathPrefix as Text
	Attribute jmxPort as Integer
	Attribute artifact as Text
	Attribute requiredMemory as Integer
		defaultValue = 512
	Schema Parameter
		Attribute name as Text
		Attribute value as Text
	Schema JVMParameter
		Attribute value as Text

Schema ServerStatus
	Attribute ts as DateTime
	Attribute id as Text
	Attribute memory as Real
	Attribute hdd as Real
	Attribute cpu as Real
	Attribute kernelTemperature as Real
	Attribute temperature as Real
	Attribute inboundConnections as Integer
	Attribute outboundConnections as Integer
Schema DeployResult
	Attribute success as Bool(defaultValue = true)
	Attribute remarks as Text